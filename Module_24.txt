Logs:
A log is a record of events that occur within an organization's systems. Logs contain log entries and each entry details information 
corresponding to a single event that happened on a device or system. Originally, logs served the sole purpose of troubleshooting 
common technology issues. For example, error logs provide information about why an unexpected error occurred and help to identify 
the root cause of the error so that it can be fixed. Today, virtually all computing devices produce some form of logs that provide 
valuable insights beyond troubleshooting. 

 Types of Logs:

 ->Network: Network logs are generated by network devices like firewalls, routers, or switches.

 ->System: System logs are generated by operating systems like Chrome OS™, Windows, Linux, or macOS®. 

 ->Application: Application logs are generated by software applications and contain information relating to the events occurring 
   within the application such as a smartphone app.

 ->Security: Security logs are generated by various devices or systems such as antivirus software and intrusion detection systems. 
   Security logs contain security-related information such as file deletion.

 ->Authentication: Authentication logs are generated whenever authentication occurs such as a successful login attempt into a 
   computer.

 Log details:
 Generally, logs contain a date, time, location, action, and author of the action. Here is an example of an authentication log:

 Login Event [05:45:15] User1 Authenticated successfully

 Logs contain information and can be adjusted to contain even more information. Verbose logging records additional, detailed 
 information beyond the default log recording. Here is an example of the same log above but logged as verbose.

 Login Event [2022/11/16 05:45:15.892673] auth_performer.cc:470 User1 Authenticated successfully from device1 (192.168.1.2)

Log management:
Because all devices produce logs, it can quickly become overwhelming for organizations to keep track of all the logs that are 
generated. To get the most value from your logs, you need to choose exactly what to log, how to access it easily, and keep it 
secure using log management. Log management is the process of collecting, storing, analyzing, and disposing of log data. 

 What to log:
 The most important aspect of log management is choosing what to log. Organizations are different, and their logging requirements 
 can differ too. It's important to consider which log sources are most likely to contain the most useful information depending on 
 your event of interest. This might be configuring log sources to reduce the amount of data they record, such as excluding 
 excessive verbosity. Some information, including but not limited to phone numbers, email addresses, and names, form personally 
 identifiable information (PII), which requires special handling and in some jurisdictions might not be possible to be logged.

 The issue with overlogging:
 From a security perspective, it can be tempting to log everything. This is the most common mistake organizations make. Just because 
 it can be logged, doesn't mean it needs to be logged. Storing excessive amounts of logs can have many disadvantages with some SIEM 
 tools. For example, overlogging can increase storage and maintenance costs. Additionally, overlogging can increase the load on 
 systems, which can cause performance issues and affect usability, making it difficult to search for and identify important events.

 Log retention:
 Organizations might operate in industries with regulatory requirements. For example, some regulations require organizations to 
 retain logs for set periods of time and organizations can implement log retention practices in their log management policy.

 Organizations that operate in the following industries might need to modify their log management policy to meet regulatory 
 requirements:

  ->Public sector industries, like the Federal Information Security Modernization Act (FISMA)

  ->Healthcare industries, like the Health Insurance Portability and Accountability Act of 1996 (HIPAA)

  ->Financial services industries, such as the Payment Card Industry Data Security Standard (PCI DSS), the Gramm-Leach-Bliley Act 
    (GLBA), and the Sarbanes-Oxley Act of 2002 (SOX)

 Log protection:
 Along with management and retention, the protection of logs is vital in maintaining log integrity. It’s not unusual for malicious
 actors to modify logs in attempts to mislead security teams and to even hide their activity.

 Storing logs in a centralized log server is a way to maintain log integrity. When logs are generated, they get sent to a dedicated 
 server instead of getting stored on a local machine. This makes it more difficult for attackers to access logs because there is a
 barrier between the attacker and the log location. 

Commonly used lof formats:

->Syslog

->JavaScript Object Notation (JSON)

->eXtensible Markup Language (XML)

->Comma Separated Values (CSV)

 JavaScript Object Notation (JSON):
 JavaScript Object Notation (JSON) is a file format that is used to store and transmit data. JSON is known for being lightweight and 
 easy to read and write. It is used for transmitting data in web technologies and is also commonly used in cloud environments. JSON 
 syntax is derived from JavaScript syntax. If you are familiar with JavaScript, you might recognize that JSON contains components 
 from JavaScript including:

 ->Key-value pairs: A key-value pair is a set of data that represents two linked items: a key and its corresponding value. A key-value 
   pair consists of a key followed by a colon, and then followed by a value. An example of a key-value pair is  "Alert": "Malware".

 ->Commas: Commas are used to separate data. For example: "Alert": "Malware", "Alert code": 1090, "severity": 10.

 ->Double quotes: Double quotes are used to enclose text data, which is also known as a string, for example:  "Alert": "Malware". 
   Data that contains numbers is not enclosed in quotes, like this: "Alert code": 1090.

 ->Curly brackets: Curly brackets enclose an object, which is a data type that stores data in a comma-separated list of key-value 
   pairs. Objects are often used to describe multiple properties for a given key. JSON log entries start and end with a curly 
   bracket. In this example, User is the object that contains multiple properties:

   "User":
   { 
       "id": "1234", 
       "name": "user",
       "role": "engineer"
   }

 ->Square brackets: Square brackets are used to enclose an array, which is a data type that stores data in a comma-separated ordered 
   list. Arrays are useful when you want to store data as an ordered collection, for example: ["Administrators", "Users", "Engineering"].

 Syslog:
 Syslog is a standard for logging and transmitting data. It can be used to refer to any of its three different capabilities: 

 1.Protocol: The syslog protocol is used to transport logs to a centralized log server for log management. It uses port 514 for 
   plaintext logs and port 6514 for encrypted logs.

 2.Service: The syslog service acts as a log forwarding service that consolidates logs from multiple sources into a single location. 
   The service works by receiving and then forwarding any syslog log entries to a remote server. 

 3.Log format: The syslog log format is one of the most commonly used log formats that you will be focusing on. It is the native 
   logging format used in  Unix® systems. It consists of three components: a header, structured-data, and a message.

 Here is an example of a syslog entry that contains all three components: a header, followed by structured-data, and a message:

 <236>1 2022-03-21T01:11:11.003Z virtual.machine.com evntslog - ID01 [user@32473 iut="1" eventSource="Application" eventID="9999"] 
 This is a log entry!

  Header:
  The header contains details like the timestamp; the hostname, which is the name of the machine that sends the log; the application 
  name; and the message ID. 

  ->Timestamp: The timestamp in this example is 2022-03-21T01:11:11.003Z, where 2022-03-21 is the date in YYYY-MM-DD format. T is 
    used to separate the date and the time. 01:11:11.003 is the 24-hour format of the time and includes the number of milliseconds 
    003. Z indicates the timezone, which is Coordinated Universal Time (UTC). 

  ->Hostname: virtual.machine.com 

  ->Application: evntslog 

  ->Message ID: ID01

  Structured-data:
  The structured-data portion of the log entry contains additional logging information. This information is enclosed in square 
  brackets and structured in key-value pairs. Here, there are three keys with corresponding values: [user@32473 iut="1" 
  eventSource="Application" eventID="9999"].

  Message:
  The message contains a detailed log message about the event. Here, the message is This is a log entry!.

  Priority (PRI):
  The priority (PRI) field indicates the urgency of the logged event and is contained with angle brackets. In this example, the 
  priority value is <236> . Generally, the lower the priority level, the more urgent the event is. 

  Note: Syslog headers can be combined with JSON, and XML formats. Custom log formats also exist.

 XML (eXtensible Markup Language):
 XML (eXtensible Markup Language) is a language and a format used for storing and transmitting data. XML is a native file format 
 used in Windows systems. XML syntax uses the following:

 ->Tags: XML uses tags to store and identify data. Tags are pairs that must contain a start tag and an end tag. The start tag 
   encloses data with angle brackets, for example <tag>,  whereas the end of a tag encloses data with angle brackets and a forward 
   slash like this: </tag>. 

 ->Elements: XML elements include both the data contained inside of a tag and the tags itself. All XML entries must contain at least 
   one root element. Root elements contain other elements that sit underneath them, known as child elements. 

   Here is an example:

   <Event>	
       <EventID>4688</EventID>
       <Version>5</Version>
   </Event>

   In this example, <Event> is the root element and contains two child elements <EventID> and <Version>. There is data contained 
   in each respective child element.

 ->Attributes: XML elements can also contain attributes. Attributes are used to provide additional information about elements. 
   Attributes are included as the second part of the tag itself and must always be quoted using either single or double quotes.

   For example:

   <EventData>
       <Data Name='SubjectUserSid'>S-2-3-11-160321</Data>
       <Data Name='SubjectUserName'>JSMITH</Data>
       <Data Name='SubjectDomainName'>ADCOMP</Data>
       <Data Name='SubjectLogonId'>0x1cf1c12</Data>
       <Data Name='NewProcessId'>0x1404</Data>
   </EventData>

   In the first line for this example, the tag is <Data> and it uses the attribute  Name='SubjectUserSid' to describe the data 
   enclosed in the tag S-2-3-11-160321.

 CSV (Comma Separated Value):
 CSV (Comma Separated Value) uses commas to separate data values. In CSV logs, the position of the data corresponds to its field 
 name, but the field names themselves might not be included in the log. It’s critical to understand what fields the source device 
 (like an IPS, firewall, scanner, etc.) is including in the log. 

 Here is an example:

 2009-11-24T21:27:09.534255,ALERT,192.168.2.7, 1041,x.x.250.50,80,TCP,ALLOWED,1:2001999:9,"ET MALWARE BTGrab.com Spyware Downloading 
 Ads",1

 CEF (Common Event Format):
 Common Event Format (CEF) is a log format that uses key-value pairs to structure data and identify fields and their corresponding 
 values. The CEF syntax is defined as containing the following fields: 

 CEF:Version|Device Vendor|Device Product|Device Version|Signature ID|Name|Severity|Extension 

 Fields are all separated with a pipe character |. However, anything in the Extension part of the CEF log entry must be written in 
 a key-value format. Syslog is a common method used to transport logs like CEF. When Syslog is used a timestamp and hostname will 
 be prepended to the CEF message. Here is an example of a CEF log entry that details malicious activity relating to a worm 
 infection:

 Sep 29 08:26:10 host CEF:1|Security|threatmanager|1.0|100|worm successfully stopped|10|src=10.0.0.2 dst=2.1.2.2 spt=1232

 Here is a breakdown of the fields:

 ->Syslog Timestamp: Sep 29 08:26:10

 ->Syslog Hostname: host

 ->Version:  CEF:1

 ->Device Vendor: Security

 ->Device Product: threatmanager

 ->Device Version: 1.0

 ->Signature ID: 100

 ->Name: worm successfully stopped

 ->Severity: 10

 ->Extension: This field contains data written as key-value pairs. There are two IP addresses, src=10.0.0.2 and dst=2.1.2.2, and a 
   source port number spt=1232. Extensions are not required and are optional to add.

 This log entry contains details about a Security application called threatmanager that successfully stopped a worm from spreading 
 from the internal network at 10.0.0.2 to the external network 2.1.2.2 through the port 1232. A high severity level of 10 is 
 reported.

 Note: Extensions and syslog prefix are optional to add to a CEF log.
  
Telemetry:
The collection and transmission of data for analysis.

Endpoint:
Any device connected on a network.


Intrusion Detection System:
An intrusion detection system (IDS) is an application that monitors system activity and alerts on possible intrusions.

 Host-based intrusion detection system:
 A host-based intrusion detection system (HIDS) is an application that monitors the activity of the host on which it's installed. 
 A HIDS is installed as an agent on a host. A host is also known as an endpoint. Typically, HIDS agents are installed on all 
 endpoints and used to monitor and detect security threats. A HIDS monitors internal activity happening on the host to identify any 
 unauthorized or abnormal behavior. If anything unusual is detected, such as the installation of an unauthorized application, the 
 HIDS logs it and sends out an alert. In addition to monitoring inbound and outbound traffic flows, HIDS can have additional 
 capabilities, such as monitoring file systems, system resource usage, user activity, and more. 

 Network-based intrusion detection system:
 A network-based intrusion detection system (NIDS) is an application that collects and monitors network traffic and network data. 
 NIDS software is installed on devices located at specific parts of the network that you want to monitor. The NIDS application 
 inspects network traffic from different devices on the network. If any malicious network traffic is detected, the NIDS logs it and 
 generates an alert.

 Using a combination of HIDS and NIDS to monitor an environment can provide a multi-layered approach to intrusion detection and 
 response. HIDS and NIDS tools provide a different perspective on the activity occurring on a network and the individual hosts that 
 are connected to it. This helps provide a comprehensive view of the activity happening in an environment.

Detection techniques:
Detection systems can use different techniques to detect threats and attacks. The two types of detection techniques that are commonly 
used by IDS technologies are signature-based analysis and anomaly-based analysis.

 Signature-based analysis:
 Signature analysis, or signature-based analysis, is a detection method that is used to find events of interest. A signature is a pattern 
 that is associated with malicious activity. Signatures can contain specific patterns like a sequence of binary numbers, bytes, or even 
 specific data like an IP address. IoCs and other indicators of attack can be useful for creating targeted signatures to detect and block 
 attacks. Different types of signatures can be used depending on which type of threat or attack you want to detect. For example, an 
 anti-malware signature contains patterns associated with malware. This can include malicious scripts that are used by the malware. 
 IDS tools will monitor an environment for events that match the patterns defined in this malware signature. If an event matches the 
 signature, the event gets logged and an alert is generated. 

  Advantages:
  ->Low rate of false positives: Signature-based analysis is very efficient at detecting known threats because it is simply comparing 
    activity to signatures. This leads to fewer false positives. Remember that a false positive is an alert that incorrectly detects 
    the presence of a threat.

  Disadvantages:
  ->Signatures can be evaded: Signatures are unique, and attackers can modify their attack behaviors to bypass the signatures. For example, 
    attackers can make slight modifications to malware code to alter its signature and avoid detection.

  ->Signatures require updates: Signature-based analysis relies on a database of signatures to detect threats. Each time a new exploit or 
    attack is discovered, new signatures must be created and added to the signature database.

  ->Inability to detect unknown threats: Signature-based analysis relies on detecting known threats through signatures. Unknown threats 
    can't be detected, such as new malware families or zero-day attacks, which are exploits that were previously unknown. 

 Anomaly-based analysis:
 Anomaly-based analysis is a detection method that identifies abnormal behavior. There are two phases to anomaly-based analysis: a training 
 phase and a detection phase. In the training phase, a baseline of normal or expected behavior must be established. Baselines are developed 
 by collecting data that corresponds to normal system behavior. In the detection phase, the current system activity is compared against this 
 baseline. Activity that happens outside of the baseline gets logged, and an alert is generated. 

  Advantages:
  ->Ability to detect new and evolving threats: Unlike signature-based analysis, which uses known patterns to detect threats, anomaly-based 
    analysis can detect unknown threats.

  Disadvantages:
  ->High rate of false positives: Any behavior that deviates from the baseline can be flagged as abnormal, including non-malicious behaviors. 
    This leads to a high rate of false positives.

  ->Pre-existing compromise: The existence of an attacker during the training phase will include malicious behavior in the baseline. This can 
    lead to missing a pre-existing attacker.

Suricata:
Suricata is an open-source intrusion detection system, intrusion prevention system, and network analysis tool.

 Suricata features:
 There are three main ways Suricata can be used:

 ->Intrusion detection system (IDS): As a network-based IDS, Suricata can monitor network traffic and alert on suspicious activities and intrusions. 
   Suricata can also be set up as a host-based IDS to monitor the system and network activities of a single host like a computer.

 ->Intrusion prevention system (IPS): Suricata can also function as an intrusion prevention system (IPS) to detect and block malicious activity 
   and traffic. Running Suricata in IPS mode requires additional configuration such as enabling IPS mode. 

 ->Network security monitoring (NSM): In this mode, Suricata helps keep networks safe by producing and saving relevant network logs. Suricata can 
   analyze live network traffic, existing packet capture files, and create and save full or conditional packet captures. This can be useful for 
   forensics, incident response, and for testing signatures. For example, you can trigger an alert and capture the live network traffic to generate 
   traffic logs, which you can then analyze to refine detection signatures.